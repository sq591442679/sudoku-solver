需求分析

- 解数独的真实场景：
  - 打印出的数独题目，做到一半难以继续，希望借助电脑解决
  - 现场手写数独题目，现编现做
- 对应需求：
  - 现实场景复杂，需要首先提取出数独实体的实际区域
  - 数独如果是手写的，则边框有可能出现扭曲，各方格间距不完全一致
  - 数字可能是印刷体与手写体混合的情况，均需要进行识别处理
  - 如果是自己编写的题目，不能保证该数独一定有解
  - 由于识别过程可能存在一定错误，需要在识别后求解前询问用户识别是否正确，并允许用户进行手工修正
  - 当求解所给条件较少时，数独可能存在多解的情况
  - 对于求解，用户可能希望不是仅仅给出一个最终结果，而是能够提供具体的解决过程和解决思路(算法)

- 相应解决策略
  - 使用语义分割首先提取出数独所在的大致区域，要求该算法能够识别手写或印刷生成的数独图像(这里也可以让用户手工修正)
  - 将该数独图像进行规整化
    - 灰度图进行闭操作，去除背景和阴影后再二值化处理
    - 识别其中数独的边框，通过仿射变换转变成规整的矩形图像
    - 通过识别纵横直线，得到所有的角点
    - 基于角点，得到每个小方格的子图像
  - 对于得到的每个子图像，使用神经网络进行手写数字识别
    - 数据增强，包含手写与印刷体等多种数字
    - 包含更多的数据集(MNIST, Chars74K等)
  - 得到最终的数独矩阵后，由前端GUI进行显示，询问用户该识别是否正确，若不正确，则允许用户手动修改其中的个别数字
  - 在用户确认无误后，调用求解算法进行数独求解
    - 若无法求解，需要报错
    - 若存在多解，可以以子窗口等形式将所有结果均予以显示
    - 动态显示每一步的求解过程
    - 显示所选择的具体算法，以及该算法的实际计算时间
    - 与整数线性规划对比，凸显算法的优越性（求解难度，时间）

- 创新点
  - 尽最大可能贴近真实场景，最大程度满足用户需求
  - 模型有较高的鲁棒性，可以允许用户进行手工修正，可以支持手写或印刷的数独图像
  - 结合了传统的图像处理与流行的神经网络等多种方法，取长补短，提升整体的准确度
  - 全程使用Matlab实现（包括神经网络训练与GUI布局设计）
  - 有一定交互性，用户体验更佳
  - 对比不同求解算法的统计信息

识别与求解接口

- 选择待识别的图像（GUI提供按钮）
- 调用数独识别函数（语义分割）
- 显示数独识别结果
- 用户判断区域是否正确，若否；则用户可自行选择数独所在区域
- 调用数字识别函数，得到数字矩阵，前端可视化
- 用户检查数字是否正确，若否；则可修改数字
- 调用求解器，进行数独求解
- 若发现数独无法求解（不合规则），则将报错信息返还给用户
- 逐步显示求解过程，输出统计信息



语义分割

- 输出中间结果
- 用灰度图进行闭操作，再做二值化
- 取最大的边框，将内部变成白色就可以提取数独
- 通过横纵角点检测，可以还原成一个9*9的标准矩阵



彩色图 ---- 灰度图 ---- 二值图 ---- 



数字识别

- 使用Chars74K进行数字识别增强
- 

数独求解

1. 考虑向量化代替for循环
2. 先判断数独是否合法（重复数字）
3. DLX算法(交叉双向十字链表)